SCPS (Secure Cloud Password Splitter)
=====================================

Overview
--------

SCPS is a password manager that eliminates the problem of the user keeping track of their encryption password. The user's encryption password is generated by SCPS and stored through secret sharing amongst the user's cloud storage accounts (Dropbox, Google Drive, OneDrive, Box). The database containing their passwords is then stored in the cloud on 2 services (for backup purposes). The user interface of SCPS is in the form of a Google Chrome Extension.

Details
-------

### User authentication

Authentication to the cloud storage services will be done through their Javascript APIs. It will be left up to the user to determine how often they want to be logged out (e.g. once every 24 hours, once a week, upon Chrome restart, etc.). When the user is logged out and needs to log in, the authentication process for all of the cloud storage services is done as seamlessly as possible, by redirecting the user directly from each cloud storage service's log in page to the next. This is done using the redirect URI's that need to be provided to each of the cloud storage services upon successful authentication. Below is an overview of how this works:

Make one redirect page for everything - user never stays on this page (always immediately redirected)


User presses "log in", which takes them to the redirect uri which is one big control flow:



	if got here from pressing log in (redirect/1)

		redirect to the dropbox auth flow

	if got here from dropbox (redirect/2)

		if successful, save token, redirect immediately to gdrive auth flow

		if not successful, redirect immediately to a page that says "sorry, in order to use SCPS you must grant access to all 4 cloud storage services"

	if got here from gdrive (redirect/3)

		if successful, save token, redirect to box auth flow

		if not successful, redirect to a page that says "sorry, in order to use SCPS you must grant access to all 4 cloud storage services"

	if got here from box (redirect/4)

		if successful, save token, redirect to onedrive auth flow

		if not successful, redirect to a page that says "sorry, in order to use SCPS you must grant access to all 4 cloud storage services"

	if got here from onedrive (redirect/5)

		if successful, save token, redirect to users home page

		if not successful, redirect to a page that says "sorry, in order to use SCPS you must grant access to all 4 cloud storage services"


### Encryption

The first step is to generate a 256 bit encryption key. This is done by starting with an empty string, and calling Math.random() then calling toString() on it 64 times, each time appending the result to the string. Next, when a user adds or updates passwords, the new password database is encrypted with AES encryption using the key. The SCPS extension uses the CpryptoJS library, which makes AES encyption as simple as calling CryptoJS.AES.encrypt(message, key).

### Storage of key and password database

The key is split and distributed amongst the user's authenticated cloud storage services using secret sharing. The services are Box, Dropbox, Google Drive, and OneDrive. The encrypted password database is then stored on Dropbox and Google Drive for backup.

### Secret sharing scheme

SCPS uses a (n,t) threshold scheme. Take n to be the number of shares needed, which is the number of cloud storage services used since each cloud storage service receives a share of the key, in this case n=4. Take t to be the number of shares needed to reconstruct the key. Divide the number of digits in key by n (in our case, this will always be 32/n since there are 32 characters in the 256-bit key) and take this number to be X. Then, start each share at character iX for i = 0,...,n-1. Take X(n-t+1) characters in each share. Finally, append 0,...,n-1 to the end of each respective share for reconstruction.

##### Example

Key: ABCDEFGHIJKLMNOPQRSTUVWXYZ123456

For t=3, start shares at 0, 8, 16, 24 and take 16 in each:

ABCDEFGHIJKLMNOP0

IJKLMNOPQRSTUVWX1

QRSTUVWXYZ1234562

YZ123456ABCDEFGH3

For t=2, start shares at 0, 8, 16, 24 and take 24 in each:

ABCDEFGHIJKLMNOPQRSTUVWX0

IJKLMNOPQRSTUVWXYZ1234561

QRSTUVWXYZ123456ABCDEFGH2

YZ123456ABCDEFGHIJKLMNOP3

### Retrieval of key and password database

When the user is ready to access their passwords (or if the old database needs to be retrieved in order to be updated), the encryption key first needs to be reconstructed. First, shares are retrieved from t cloud storage services (the minimum number needed for reconstruction). Then, characters can be filled into an array of length 32 by removing the final digit, which represents the ordering of the share, and then filling the share's digits into that spot. In the examples above, share 0 will get filled in starting in the 0th index of the array, share 1 will get filled in starting in the 8th index of the array, etc. Next, the password database is retrieved from Dropbox (or Google Drive in the event that Dropbox is down), and decrypted using CryptoJS.AES.decrypt(encryptedMessage, key).

Contact
-------

Katelyn Lesse

klesse413@gmail.com